import{w as j}from"./with-props-5nfPBK-j.js";import{a as c,o as t,N}from"./chunk-D4RADZKF-CEFUjEjZ.js";import"./utils-mUqetfhN.js";import"./authContext-DwKCA1uB.js";import{H as C}from"./Header-BRpT-8A_.js";import{P as v}from"./ProductCard-jHbfvcMz.js";import{A as w,u as S,a as F}from"./ProductComponent-DuU1GyGy.js";import{u as k}from"./useAuth-CWQz8NCq.js";import{g as I}from"./products-api-CvKkBCNi.js";import{u as A}from"./categoryComponent-08yfEJr3.js";import"./button.component-B0WLNDez.js";import"./template-DP_y5Sm2.js";import"./index-DIYeVvcV.js";import"./axiosAuthInterceptor-pnhKdU3P.js";const D=()=>{const[s,g]=c.useState(""),[o,m]=c.useState(null),[p,a]=c.useState([]),[l,h]=c.useState(1),i=8,{products:d}=w(),{authData:n}=k(),{categories:x}=A();S(s);const{products:f}=F(o);if(!n)return t.jsx(N,{to:"/log-in"});c.useEffect(()=>{(async()=>{try{console.log("Fetching all products from API...");const r=await I();setTimeout(()=>{a(r),console.log("Products successfully fetched.")},300)}catch(r){console.error("Failed to load products",r)}})()},[]);const y=()=>{if(console.log("Filter button clicked."),!s&&o===null){console.log("No filters applied. Showing all products."),a(d);return}if(!s&&o!==null){console.log(`Filtering by category ID using hook: ${o}`),a(f);return}let e=d;s&&(console.log(`Filtering by name: '${s}'`),e=e.filter(r=>r.name.toLowerCase().includes(s.toLowerCase()))),o!==null&&(console.log(`Further filtering by category ID: ${o}`),e=e.filter(r=>r.categoryId===o)),console.log("Final filtered data:",e),a(e)},b=()=>{console.log("Reset button clicked."),g(""),m(null),a(d)},P=p.slice((l-1)*i,l*i),u=Math.ceil(p.length/i);return t.jsxs("main",{className:"dashboard wrapper",children:[t.jsx(C,{title:`Welcome ${(n==null?void 0:n.username)??"Guest"} 👋🏼`,description:"Welcome to your dashboard"}),t.jsxs("div",{className:"flex flex-wrap gap-4 mb-6 items-center",children:[t.jsx("input",{type:"text",placeholder:"Name",value:s,onChange:e=>g(e.target.value),className:"border border-gray-300 rounded px-3 py-2"}),t.jsxs("select",{value:o!==null?o.toString():"",onChange:e=>m(e.target.value?BigInt(e.target.value):null),className:"border border-gray-300 rounded px-3 py-2",children:[t.jsx("option",{value:"",children:"Filter by Category"}),x.map(e=>t.jsx("option",{value:e.id.toString(),children:e.name},e.id.toString()))]}),t.jsx("button",{onClick:y,className:"bg-blue-600 text-white rounded px-4 py-2",children:"Filter"}),t.jsx("button",{onClick:b,className:"bg-gray-400 text-white rounded px-4 py-2",children:"Reset"})]}),t.jsx("section",{className:"flex flex-col gap-6",children:t.jsxs("section",{className:"container",children:[t.jsx("h1",{className:"text-xl font-semibold text-dark-100",children:"PRODUCTS"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 w-full",children:P.map(e=>t.jsx(v,{product:e},e.id))}),t.jsxs("div",{className:"flex justify-center items-center gap-4 mt-6",children:[t.jsx("button",{onClick:()=>h(e=>Math.max(e-1,1)),disabled:l===1,className:"px-4 py-2 bg-gray-300 rounded disabled:opacity-50",children:"Prev"}),t.jsxs("span",{children:["Page ",l," of ",u]}),t.jsx("button",{onClick:()=>h(e=>Math.min(e+1,u)),disabled:l===u,className:"px-4 py-2 bg-gray-300 rounded disabled:opacity-50",children:"Next"})]})]})})]})},J=j(D);export{J as default};
