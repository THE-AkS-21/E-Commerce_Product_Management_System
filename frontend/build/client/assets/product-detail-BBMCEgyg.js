import{w as U}from"./with-props-5nfPBK-j.js";import{v as k,p as A,a as o,o as e}from"./chunk-D4RADZKF-CEFUjEjZ.js";import{f}from"./utils-mUqetfhN.js";import"./authContext-DwKCA1uB.js";import{H as S}from"./Header-BRpT-8A_.js";import{g as L}from"./categoryComponent-08yfEJr3.js";import{b as B,c as T,C as F,d as O,e as i}from"./ProductComponent-DuU1GyGy.js";import{u as R}from"./products-api-CvKkBCNi.js";import{B as l}from"./button.component-B0WLNDez.js";import"./axiosAuthInterceptor-pnhKdU3P.js";import"./template-DP_y5Sm2.js";import"./index-DIYeVvcV.js";const $=()=>{const{productId:c}=k(),j=A(),{product:t,error:d}=B(Number(c)),{deleteProduct:y,loading:m}=T(),[N,b]=o.useState(!1),[a,p]=o.useState(null),[u,w]=o.useState(null),[n,x]=o.useState(!1),[g,h]=o.useState("");if(o.useEffect(()=>{t&&(async()=>{try{const r=await L(BigInt(t.categoryId));h(r)}catch(r){console.error("❌ Error fetching category name:",r),h("Unknown")}})()},[t]),console.log("📝 PRODUCT DETAIL PAGE LOADED — CATEGORY:",g),d)return e.jsx("p",{className:"text-red-500",children:d});if(!t)return e.jsx("p",{children:"Loading product details..."});const C=t.imageUrl||"/assets/icons/product.png",E=async()=>{if(window.confirm("Are you sure you want to delete this product?"))try{await y(BigInt(c)),alert("🗑️ Product deleted successfully!"),j("/all-product")}catch(s){console.error("❌ Error deleting product:",s),alert("Failed to delete product.")}},P=()=>{b(!0),p({...t})},D=s=>{const{name:r,value:I}=s.target;a&&p({...a,[r]:I})},v=async s=>{if(s.preventDefault(),!!a){x(!0),console.log("🔄 Updating Product:",a);try{const r={...a,price:parseFloat(a.price),stock:parseInt(a.stockQuantity),categoryId:parseInt(a.categoryId)};await R(Number(c),r),alert("✅ Product Updated!"),window.location.reload()}catch(r){console.error("❌ Error updating product:",r),w("Failed to update product.")}finally{x(!1)}}};return e.jsxs("main",{className:"product-detail wrapper",children:[e.jsx(S,{title:"PRODUCT DETAIL",description:"View and edit product details"}),e.jsxs("section",{className:"container wrapper-md",children:[e.jsx("header",{children:e.jsx("h1",{className:"p-40-semibold text-dark-100",children:t.name})}),e.jsx("section",{className:"gallery h-80 w-80 flex",children:e.jsx("img",{src:C,alt:t.name,className:"w-full rounded-xl object-cover md:col-span-2 md:row-span-2 h-[330px]"})}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Category: ",g]}),e.jsx("section",{className:"flex gap-3 md:gap-5 items-center flex-wrap mt-2",children:e.jsx(F,{id:"product-chip",children:e.jsxs(O,{children:[e.jsx(i,{text:`Stock: ${t.stockQuantity}`}),e.jsx(i,{text:`Created: ${f(t.createdAt)}`}),e.jsx(i,{text:`Updated: ${f(t.updatedAt)}`})]})})}),e.jsx("section",{className:"title mt-4",children:e.jsxs("h2",{children:["Price: ₹",t.price]})}),e.jsx("p",{className:"text-sm md:text-lg font-normal text-dark-400",children:t.description}),e.jsxs(l,{onClick:P,type:"button",className:"button-class !bg-blue-500/10 !h-11 !w-full md:w-[240px] mt-4",children:[e.jsx("img",{src:"/assets/icons/refresh.svg",alt:"edit",className:"size-5"}),e.jsx("span",{className:"p-16-semibold  text-green-500",children:"UPDATE"})]}),N&&e.jsxs("form",{className:"product-form mt-6",onSubmit:v,children:[["name","description","price","stockQuantity","categoryId","imageUrl"].map(s=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:s,children:s.replace(/([A-Z])/g," $1")}),e.jsx("input",{name:s,value:a[s],onChange:D,className:"form-input",placeholder:s,disabled:n})]},s)),e.jsxs(l,{type:"submit",className:"button-class !bg-primary-100 !h-11 !w-full md:w-[240px] mt-4",disabled:n,children:[e.jsx("img",{src:"/assets/icons/plus.svg",alt:"plus",className:"size-5"}),e.jsx("span",{className:"p-16-semibold text-white",children:n?"Saving...":"Save Changes"})]})]}),u&&e.jsx("p",{className:"text-red-500 mt-2",children:u}),e.jsxs(l,{onClick:E,type:"button",disabled:m,className:"button-class !bg-blue-500/10 !h-11 !w-full md:w-[240px] mt-4",children:[e.jsx("img",{src:"/assets/icons/trash.svg",alt:"delete",className:"size-5"}),e.jsx("span",{className:"p-16-semibold text-red-500",children:m?"Deleting...":"DELETE"})]})]})]})},X=U($);export{X as default};
